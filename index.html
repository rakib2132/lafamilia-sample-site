<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>La Familia Tobacco Vape & Smoke Shop | Smoke Shop in Hialeah, FL</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta
    name="description"
    content="La Familia Tobacco Vape & Smoke Shop in Hialeah, FL offers disposable vapes, cigars, tobacco, hookah flavors, glass pipes and smoking accessories. Visit us at 1505 West Okeechobee Road."
  />

  <!-- Google Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
    rel="stylesheet"
  />

  <style>
    :root {
      --bg: #050507;
      --bg-alt: #101018;
      --primary: #f97316;
      --primary-soft: rgba(249, 115, 22, 0.1);
      --accent: #22c55e;
      --text: #f9fafb;
      --muted: #9ca3af;
      --border: #1f2933;
      --card: #0b0b11;
      --radius-lg: 18px;
      --radius-xl: 22px;
      --shadow-soft: 0 18px 45px rgba(0, 0, 0, 0.55);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: "Poppins", system-ui, -apple-system, BlinkMacSystemFont,
        "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #111827 0, #020617 45%, #000 100%);
      color: var(--text);
      line-height: 1.6;
      min-height: 100vh;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    .page-wrapper {
      max-width: 1200px;
      margin: 0 auto;
      padding: 16px 12px 48px;
    }

    @media (min-width: 768px) {
      .page-wrapper {
        padding: 20px 16px 60px;
      }
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .brand-logo {
      width: 44px;
      height: 44px;
      border-radius: 999px;
      border: 1px solid rgba(249, 115, 22, 0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at 30% 0, #f97316 0, #7c2d12 30%, #020617 75%);
      box-shadow: 0 0 25px rgba(249, 115, 22, 0.35);
      font-weight: 700;
      font-size: 18px;
      letter-spacing: 1px;
      flex-shrink: 0;
    }

    .brand-text h1 {
      font-size: 1.02rem;
      font-weight: 600;
      letter-spacing: 0.03em;
    }

    .brand-text span {
      display: block;
      font-size: 0.75rem;
      color: var(--muted);
    }

    .cta-pill {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: var(--primary-soft);
      color: #fed7aa;
      padding: 7px 14px;
      border-radius: 999px;
      font-size: 0.78rem;
      border: 1px solid rgba(249, 115, 22, 0.4);
      white-space: nowrap;
    }

    .cta-pill-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.25);
    }

    @media (max-width: 600px) {
      header {
        flex-direction: column;
        align-items: flex-start;
      }
      .cta-pill {
        width: 100%;
        justify-content: center;
      }
    }

    /* Hero section */

    .hero {
      display: grid;
      grid-template-columns: minmax(0, 3fr) minmax(0, 2.1fr);
      gap: 20px;
      margin-bottom: 24px;
    }

    @media (max-width: 840px) {
      .hero {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .hero-main {
      background: radial-gradient(circle at top left, #111827 0, #020617 45%);
      border-radius: var(--radius-xl);
      padding: 18px 16px 20px;
      border: 1px solid rgba(148, 163, 184, 0.25);
      box-shadow: var(--shadow-soft);
      position: relative;
      overflow: hidden;
    }

    @media (min-width: 768px) {
      .hero-main {
        padding: 22px 22px 24px;
      }
    }

    .hero-main::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at top right, rgba(249, 115, 22, 0.08), transparent 55%);
      opacity: 0.9;
      pointer-events: none;
    }

    .hero-kicker {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 0.78rem;
      padding: 4px 9px;
      border-radius: 999px;
      margin-bottom: 8px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.35);
      color: var(--muted);
    }

    .hero-kicker span {
      color: #facc15;
      font-size: 0.78rem;
    }

    .hero-title {
      font-size: 1.5rem;
      line-height: 1.18;
      margin-bottom: 8px;
    }

    @media (min-width: 768px) {
      .hero-title {
        font-size: 1.8rem;
      }
    }

    .hero-title span {
      color: var(--primary);
    }

    .hero-subtitle {
      font-size: 0.9rem;
      color: var(--muted);
      margin-bottom: 12px;
      max-width: 34rem;
    }

    .hero-badges {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 14px;
      font-size: 0.76rem;
    }

    .badge {
      padding: 5px 9px;
      border-radius: 999px;
      border: 1px solid rgba(156, 163, 175, 0.5);
      background: rgba(15, 23, 42, 0.9);
      color: var(--muted);
    }

    .badge strong {
      color: #e5e7eb;
      font-weight: 500;
    }

    .hero-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 14px;
    }

    .btn-primary,
    .btn-secondary {
      border-radius: 999px;
      padding: 8px 14px;
      font-size: 0.88rem;
      border: none;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-weight: 500;
      transition: transform 0.12s ease, box-shadow 0.12s ease, background 0.12s ease;
      text-decoration: none;
    }

    .btn-primary {
      background: linear-gradient(to right, #f97316, #ea580c);
      color: #111827;
      box-shadow: 0 14px 40px rgba(249, 115, 22, 0.65);
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 20px 55px rgba(249, 115, 22, 0.9);
    }

    .btn-secondary {
      background: rgba(15, 23, 42, 0.95);
      color: #e5e7eb;
      border: 1px solid rgba(148, 163, 184, 0.5);
    }

    .btn-secondary:hover {
      transform: translateY(-1px);
      box-shadow: 0 15px 45px rgba(15, 23, 42, 0.75);
      background: rgba(15, 23, 42, 0.98);
    }

    .hero-footer {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      font-size: 0.78rem;
      color: var(--muted);
    }

    .hero-footer span {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #22c55e;
    }

    .hero-highlight {
      background: rgba(15, 23, 42, 0.9);
      border-radius: var(--radius-lg);
      padding: 8px 10px;
      border: 1px solid rgba(148, 163, 184, 0.45);
      font-size: 0.78rem;
      margin-top: 8px;
      overflow-wrap: break-word;
      word-break: break-word;
    }

    .hero-highlight strong {
      color: #e5e7eb;
    }

    .hero-aside {
      background: rgba(15, 23, 42, 0.95);
      border-radius: var(--radius-xl);
      padding: 16px 14px 18px;
      border: 1px solid rgba(148, 163, 184, 0.3);
      box-shadow: var(--shadow-soft);
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .aside-tag {
      font-size: 0.74rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--muted);
    }

    .aside-block {
      background: rgba(15, 23, 42, 0.9);
      border-radius: var(--radius-lg);
      padding: 9px 10px;
      border: 1px solid rgba(31, 41, 55, 0.9);
      font-size: 0.78rem;
    }

    .aside-subtitle {
      font-size: 0.78rem;
      color: var(--muted);
      margin-bottom: 4px;
    }

    .aside-title {
      font-size: 0.9rem;
      font-weight: 500;
      margin-bottom: 4px;
    }

    .aside-highlight {
      font-size: 0.78rem;
      color: #e5e7eb;
    }

    .hours-grid {
      display: grid;
      grid-template-columns: 1.2fr 1.3fr;
      gap: 4px;
      font-size: 0.78rem;
      color: var(--muted);
      margin-top: 4px;
    }

    .hours-grid strong {
      color: #e5e7eb;
      font-weight: 500;
    }

    .map-link {
      margin-top: 6px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 0.78rem;
      color: #93c5fd;
    }

    .map-link span {
      font-size: 0.9rem;
    }

    /* Filter bar and products */

    .section-title-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 12px 0 8px;
      gap: 10px;
      flex-wrap: wrap;
    }

    .section-title-row h2 {
      font-size: 1rem;
      font-weight: 500;
    }

    .section-title-row span {
      font-size: 0.78rem;
      color: var(--muted);
    }

    .cart-summary {
      font-size: 0.8rem;
      color: var(--muted);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .cart-summary strong {
      color: #e5e7eb;
    }

    .cart-summary span#cartCount {
      color: #facc15;
      font-weight: 600;
    }

    .filter-bar {
      background: rgba(15, 23, 42, 0.95);
      border-radius: var(--radius-lg);
      padding: 9px 9px;
      border: 1px solid rgba(31, 41, 55, 0.95);
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
    }

    @media (min-width: 768px) {
      .filter-bar {
        padding: 10px 12px;
      }
    }

    .filter-group {
      display: flex;
      gap: 8px;
      flex: 1 1 180px;
    }

    .filter-group input,
    .filter-group select {
      flex: 1 1 auto;
      min-width: 0;
      padding: 7px 10px;
      border-radius: 999px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: #020617;
      color: #e5e7eb;
      font-size: 0.8rem;
      outline: none;
    }

    .filter-group input::placeholder {
      color: #6b7280;
    }

    .filter-note {
      font-size: 0.76rem;
      color: var(--muted);
      flex: 1 1 100%;
    }

    .product-grid {
      display: grid;
      gap: 12px;
      margin-top: 12px;
    }

    @media (min-width: 640px) {
      .product-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    @media (min-width: 980px) {
      .product-grid {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    .product-card {
      position: relative;
      background: radial-gradient(circle at top left, #111827 0, #020617 86%);
      border-radius: var(--radius-lg);
      padding: 10px 10px 11px;
      border: 1px solid rgba(31, 41, 55, 0.85);
      box-shadow: 0 15px 40px rgba(15, 23, 42, 0.9);
      overflow: hidden;
    }

    .product-image-wrap {
      width: 100%;
      border-radius: 14px;
      margin-bottom: 8px;
      background: #020617;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 180px;
    }

    @media (min-width: 768px) {
      .product-image-wrap {
        height: 200px;
      }
    }

    .product-image {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
      display: block;
    }

    .product-badge {
      position: absolute;
      top: 9px;
      right: 10px;
      font-size: 0.68rem;
      padding: 2px 7px;
      border-radius: 999px;
      color: #fefce8;
      background: rgba(34, 197, 94, 0.2);
      border: 1px solid rgba(34, 197, 94, 0.7);
    }

    .product-badge.out {
      background: rgba(248, 113, 113, 0.18);
      border-color: rgba(248, 113, 113, 0.8);
      color: #fee2e2;
    }

    .product-name {
      font-size: 0.9rem;
      margin-bottom: 2px;
      padding-right: 70px;
    }

    .product-meta {
      font-size: 0.74rem;
      color: var(--muted);
      margin-bottom: 5px;
    }

    .product-description {
      font-size: 0.76rem;
      color: #d1d5db;
      margin-bottom: 7px;
    }

    .flavor-row {
      margin-bottom: 7px;
      font-size: 0.76rem;
      color: var(--muted);
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .flavor-row label {
      font-size: 0.74rem;
    }

    .flavor-select {
      padding: 5px 8px;
      border-radius: 999px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: #020617;
      color: #e5e7eb;
      font-size: 0.76rem;
      outline: none;
    }

    .add-to-cart-btn {
      margin-bottom: 7px;
      border-radius: 999px;
      padding: 6px 10px;
      font-size: 0.78rem;
      border: none;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-weight: 500;
      background: rgba(15, 23, 42, 0.95);
      color: #e5e7eb;
      border: 1px solid rgba(148, 163, 184, 0.5);
    }

    .add-to-cart-btn:hover {
      background: rgba(15, 23, 42, 0.98);
      box-shadow: 0 10px 30px rgba(15, 23, 42, 0.8);
    }

    .add-to-cart-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      box-shadow: none;
    }

    .product-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.8rem;
      gap: 6px;
    }

    .price {
      font-weight: 600;
      color: #fbbf24;
    }

    .product-tag {
      font-size: 0.74rem;
      color: var(--muted);
      text-align: right;
      flex-shrink: 0;
    }

    .bulk-deal {
      margin-top: 4px;
      font-size: 0.72rem;
      color: #bbf7d0;
    }

    .empty-state {
      margin-top: 16px;
      font-size: 0.84rem;
      color: var(--muted);
      text-align: center;
    }

    footer {
      margin-top: 28px;
      border-top: 1px solid rgba(31, 41, 55, 0.85);
      padding-top: 14px;
      font-size: 0.76rem;
      color: var(--muted);
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: space-between;
    }

    footer span {
      display: inline-flex;
      gap: 6px;
      align-items: center;
    }

    footer a {
      color: #93c5fd;
    }

    .nowrap {
      white-space: nowrap;
    }

    /* Deals popup */

    .deal-modal {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 50;
    }

    .deal-modal.show {
      display: flex;
    }

    .deal-modal-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(15, 23, 42, 0.75);
      backdrop-filter: blur(4px);
    }

    .deal-modal-content {
      position: relative;
      z-index: 51;
      max-width: 360px;
      width: 90%;
      background: #020617;
      border-radius: 18px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.85);
      padding: 16px 16px 18px;
      color: #e5e7eb;
    }

    .deal-modal-content h2 {
      font-size: 1rem;
      margin-bottom: 8px;
    }

    .deal-modal-content ul {
      list-style: disc;
      padding-left: 18px;
      font-size: 0.82rem;
    }

    .deal-modal-content li {
      margin-bottom: 4px;
    }

    .deal-modal-close {
      position: absolute;
      top: 8px;
      right: 10px;
      border: none;
      background: transparent;
      color: #9ca3af;
      font-size: 1rem;
      cursor: pointer;
    }

    .deal-modal-actions {
      margin-top: 10px;
      display: flex;
      justify-content: flex-start;
    }

    .deal-modal-actions button {
      border-radius: 999px;
      padding: 7px 14px;
      font-size: 0.82rem;
      border: none;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-weight: 500;
      background: linear-gradient(to right, #f97316, #ea580c);
      color: #111827;
      box-shadow: 0 10px 30px rgba(249, 115, 22, 0.55);
    }

    .deal-modal-actions button:hover {
      transform: translateY(-1px);
      box-shadow: 0 16px 40px rgba(249, 115, 22, 0.8);
    }
  </style>

  <!-- Local SEO JSON-LD -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "SmokeShop",
    "name": "La Familia Tobacco Vape & Smoke Shop",
    "address": {
      "@type": "PostalAddress",
      "streetAddress": "1505 West Okeechobee Road",
      "addressLocality": "Hialeah",
      "addressRegion": "FL",
      "postalCode": "33010",
      "addressCountry": "US"
    },
    "telephone": "",
    "url": "",
    "priceRange": "$",
    "servesCuisine": "Hookah, Vape, Tobacco",
    "geo": {
      "@type": "GeoCoordinates",
      "latitude": 25.832,
      "longitude": -80.292
    }
  }
  </script>
</head>

<body>
  <!-- Deals popup -->
  <div id="dealModal" class="deal-modal">
    <div class="deal-modal-backdrop"></div>
    <div class="deal-modal-content">
      <button class="deal-modal-close" id="dealModalClose" aria-label="Close deals popup">‚úï</button>
      <h2>Today‚Äôs Specials</h2>
      <ul>
        <li><strong>Elf Bar:</strong> 2 for $35 (mix & match)</li>
        <li><strong>Lost Mary & HQD:</strong> bundle deals available</li>
        <li><strong>Hookah flavors:</strong> Buy 3, get 1 free</li>
        <li><strong>Selected glass:</strong> 10% off</li>
      </ul>
      <p style="font-size:0.78rem; color:#9ca3af; margin-top:8px;">
        In-store only ¬∑ Ask at the counter for details.
      </p>
      <div class="deal-modal-actions">
        <button id="viewDealsBtn">View all deals ‚Üì</button>
      </div>
    </div>
  </div>

  <div class="page-wrapper">
    <header>
      <div class="brand">
        <div class="brand-logo">LF</div>
        <div class="brand-text">
          <h1>La Familia Tobacco Vape & Smoke Shop</h1>
          <span>1505 West Okeechobee Road ¬∑ Hialeah, FL</span>
        </div>
      </div>
      <div class="cta-pill">
        <div class="cta-pill-dot"></div>
        Open late ¬∑ Vapes ¬∑ Tobacco ¬∑ Hookah ¬∑ Glass
      </div>
    </header>

    <main>
      <section class="hero">
        <div class="hero-main">
          <div class="hero-kicker">
            <span>Hialeah, Florida</span> ¬∑ Your neighborhood smoke shop
          </div>
          <h2 class="hero-title">
            All your <span>tobacco, vape & smoke</span> essentials in one place.
          </h2>
          <p class="hero-subtitle">
            Discover a curated selection of disposable vapes, cigars, tobacco, hookah flavors,
            glass pieces and accessories ‚Äî right here in Hialeah. Check what's in stock before you visit.
          </p>

          <div class="hero-badges">
            <div class="badge"><strong>Vapes:</strong> disposables, juice & more</div>
            <div class="badge"><strong>Tobacco & cigars</strong> from popular brands</div>
            <div class="badge"><strong>Hookah</strong> flavors & charcoal</div>
            <div class="badge"><strong>Glass</strong> pipes & water pieces</div>
          </div>

          <div class="hero-actions">
            <a
              class="btn-primary"
              href="https://www.google.com/maps/search/?api=1&query=La+Familia+Tobacco+Vape+%26+Smoke+Shop+1505+West+Okeechobee+Road+Hialeah+FL"
              target="_blank" rel="noopener"
            >
              Open in Google Maps
            </a>
            <a class="btn-secondary" href="#products">
              Browse product list
            </a>
          </div>

          <div class="hero-footer">
            <span><span class="dot"></span> In-store pickup only</span>
            <span>Prices and availability may vary, call or visit to confirm.</span>
          </div>
        </div>

        <aside class="hero-aside">
          <div class="aside-tag">Visit us</div>
          <div class="aside-block">
            <div class="aside-title">Store location</div>
            <div class="aside-subtitle">
              1505 West Okeechobee Road<br />
              Hialeah, FL 33010
            </div>
            <a
              class="map-link"
              href="https://www.google.com/maps/search/?api=1&query=La+Familia+Tobacco+Vape+%26+Smoke+Shop+1505+West+Okeechobee+Road+Hialeah+FL"
              target="_blank" rel="noopener"
            >
              <span>üìç</span> View on Google Maps
            </a>
          </div>

          <div class="aside-block">
            <div class="aside-title">Hours</div>
            <div class="aside-subtitle">
              Edit these to match your real hours.
            </div>
            <div class="hours-grid">
              <div><strong>Mon ‚Äì Thu</strong></div>
              <div>10:00 AM ‚Äì 11:00 PM</div>
              <div><strong>Fri ‚Äì Sat</strong></div>
              <div>10:00 AM ‚Äì 12:00 AM</div>
              <div><strong>Sunday</strong></div>
              <div>11:00 AM ‚Äì 10:00 PM</div>
            </div>
          </div>

          <div class="aside-block">
            <div class="aside-title">Questions or special products?</div>
            <div class="aside-subtitle">
              Add your phone or social media here so customers can contact you.
            </div>
            <div class="aside-highlight">
              Tel: (305) 123-4567<br />
              Instagram: @lafamiliatobaccovape
            </div>
          </div>
        </aside>
      </section>

      <section id="products">
        <div class="section-title-row">
          <div>
            <h2>Product list</h2>
            <span>Live view of items from <code style="font-size: 0.7rem;">products.json</code></span>
          </div>
          <div class="cart-summary">
            üõí <strong>Cart:</strong> <span id="cartCount">0</span> items
          </div>
        </div>

        <div class="filter-bar">
          <div class="filter-group">
            <input
              type="text"
              id="searchInput"
              placeholder="Search by name, brand or type..."
            />
          </div>
          <div class="filter-group">
            <select id="categorySelect">
              <option value="">All categories</option>
              <option value="Deals">Deals only</option>
              <option value="Disposable Vape">Disposable vapes</option>
              <option value="Vape">Vape & juice</option>
              <option value="Tobacco">Tobacco</option>
              <option value="Cigar">Cigars</option>
              <option value="Hookah">Hookah</option>
              <option value="Glass">Glass pieces</option>
              <option value="Accessory">Accessories</option>
            </select>
          </div>
          <div class="filter-note">
            Products and prices are for in-store purchase. Call or visit to confirm stock.
          </div>
        </div>

        <div id="productGrid" class="product-grid"></div>
        <div id="emptyState" class="empty-state" style="display: none;">
          No products match your search. Try a different keyword or category.
        </div>
        <div id="loadError" class="empty-state" style="display: none; color: #fecaca;">
          Could not load products. Make sure <code>products.json</code> is uploaded
          to the same folder as this page.
        </div>
      </section>
    </main>

    <footer>
      <span>¬© <span id="year"></span> La Familia Tobacco Vape & Smoke Shop</span>
      <span>
        Built for local SEO in Hialeah ¬∑
        <span class="nowrap">Search: ‚Äúsmoke shop Hialeah‚Äù ¬∑ ‚Äúvape shop near me‚Äù</span>
      </span>
    </footer>
  </div>

  <script>
    // Footer year
    document.getElementById("year").textContent = new Date().getFullYear();

    const productGrid = document.getElementById("productGrid");
    const emptyState = document.getElementById("emptyState");
    const loadError = document.getElementById("loadError");
    const searchInput = document.getElementById("searchInput");
    const categorySelect = document.getElementById("categorySelect");
    const cartCountEl = document.getElementById("cartCount");

    let products = [];
    let cart = [];

    function updateCartCount() {
      cartCountEl.textContent = cart.length;
    }

    async function loadProducts() {
      try {
        const res = await fetch("products.json?_=" + Date.now());
        if (!res.ok) {
          throw new Error("HTTP error " + res.status);
        }
        products = await res.json();
        renderProducts(products);
      } catch (e) {
        console.error("Error loading products:", e);
        loadError.style.display = "block";
      }
    }

    function renderProducts(list) {
      productGrid.innerHTML = "";
      if (!list || list.length === 0) {
        emptyState.style.display = "block";
        return;
      } else {
        emptyState.style.display = "none";
      }

      list.forEach((p) => {
        const card = document.createElement("article");
        card.className = "product-card";

        // Image
        if (p.image) {
          const wrap = document.createElement("div");
          wrap.className = "product-image-wrap";

          const img = document.createElement("img");
          img.src = p.image;
          img.alt = p.name || "Product image";
          img.className = "product-image";

          wrap.appendChild(img);
          card.appendChild(wrap);
        }

        const badge = document.createElement("div");
        badge.className = "product-badge" + (p.inStock === false ? " out" : "");
        badge.textContent = p.inStock === false ? "Out of stock" : "In stock";
        card.appendChild(badge);

        const name = document.createElement("h3");
        name.className = "product-name";
        name.textContent = p.name || "Unnamed product";
        card.appendChild(name);

        const meta = document.createElement("div");
        meta.className = "product-meta";
        const metaParts = [];
        if (p.brand) metaParts.push(p.brand);
        if (p.category) metaParts.push(p.category);
        meta.textContent = metaParts.join(" ¬∑ ");
        card.appendChild(meta);

        if (p.description) {
          const desc = document.createElement("p");
          desc.className = "product-description";
          desc.textContent = p.description;
          card.appendChild(desc);
        }

        let flavorSelect = null;

        if (Array.isArray(p.flavors) && p.flavors.length > 0) {
          const flavorRow = document.createElement("div");
          flavorRow.className = "flavor-row";

          const label = document.createElement("label");
          label.textContent = "Flavor";

          flavorSelect = document.createElement("select");
          flavorSelect.className = "flavor-select";

          const placeholderOpt = document.createElement("option");
          placeholderOpt.value = "";
          placeholderOpt.textContent = "Select a flavor";
          flavorSelect.appendChild(placeholderOpt);

          p.flavors.forEach((flavor) => {
            const opt = document.createElement("option");
            opt.value = flavor;
            opt.textContent = flavor;
            flavorSelect.appendChild(opt);
          });

          flavorRow.appendChild(label);
          flavorRow.appendChild(flavorSelect);
          card.appendChild(flavorRow);
        }

        const addBtn = document.createElement("button");
        addBtn.className = "add-to-cart-btn";
        addBtn.type = "button";
        addBtn.textContent = "Add to cart";

        // Disable button if out of stock
        if (p.inStock === false) {
          addBtn.disabled = true;
        }

        addBtn.addEventListener("click", () => {
          let chosenFlavor = null;

          if (flavorSelect) {
            chosenFlavor = flavorSelect.value;
            if (!chosenFlavor) {
              alert("Please select a flavor first.");
              return;
            }
          }

          cart.push({
            name: p.name,
            flavor: chosenFlavor,
            price: typeof p.price === "number" ? p.price : null
          });

          updateCartCount();
        });

        card.appendChild(addBtn);

        const footer = document.createElement("div");
        footer.className = "product-footer";

        const price = document.createElement("div");
        price.className = "price";
        if (typeof p.price === "number") {
          price.textContent = "$" + p.price.toFixed(2);
        } else {
          price.textContent = "Ask in store";
        }

        const tag = document.createElement("div");
        tag.className = "product-tag";
        tag.textContent = p.category || "Product";

        footer.appendChild(price);
        footer.appendChild(tag);
        card.appendChild(footer);

        // Bulk / special deal text
        if (p.dealText) {
          const deal = document.createElement("div");
          deal.className = "bulk-deal";
          deal.textContent = p.dealText;
          card.appendChild(deal);
        }

        productGrid.appendChild(card);
      });
    }

    function applyFilters() {
      const term = (searchInput.value || "").toLowerCase();
      const category = categorySelect.value;

      const filtered = products.filter((p) => {
        const isDeal = !!p.dealText;
        let matchesCategory = true;

        if (category === "Deals") {
          matchesCategory = isDeal;
        } else if (category) {
          matchesCategory = p.category === category;
        }

        const haystack = [
          p.name,
          p.brand,
          p.category,
          p.description,
          p.dealText,
          ...(Array.isArray(p.flavors) ? p.flavors : [])
        ]
          .filter(Boolean)
          .join(" ")
          .toLowerCase();

        const matchesSearch = !term || haystack.includes(term);

        return matchesCategory && matchesSearch;
      });

      renderProducts(filtered);
    }

    searchInput.addEventListener("input", () => {
      applyFilters();
    });

    categorySelect.addEventListener("change", () => {
      applyFilters();
    });

    loadProducts();

    // --- Deals popup with 30s delay + "View all deals" ---
    function showDealsPopupOnce() {
      const modal = document.getElementById("dealModal");
      const closeBtn = document.getElementById("dealModalClose");
      const viewDealsBtn = document.getElementById("viewDealsBtn");
      if (!modal || !closeBtn) return;

      const dismissed = localStorage.getItem("lfDealsDismissed");
      if (dismissed === "1") return;

      modal.classList.add("show");

      function closeModal() {
        modal.classList.remove("show");
        localStorage.setItem("lfDealsDismissed", "1");
      }

      closeBtn.addEventListener("click", closeModal);
      modal.addEventListener("click", (e) => {
        if (e.target === modal) {
          closeModal();
        }
      });

      if (viewDealsBtn) {
        viewDealsBtn.addEventListener("click", () => {
          const categorySelectEl = document.getElementById("categorySelect");
          if (categorySelectEl) {
            categorySelectEl.value = "Deals";
            applyFilters();
          }
          const productsSection = document.getElementById("products");
          if (productsSection) {
            productsSection.scrollIntoView({ behavior: "smooth" });
          }
          closeModal();
        });
      }
    }

    window.addEventListener("load", () => {
      // 30,000 ms = 30 seconds
      setTimeout(showDealsPopupOnce, 15000);
    });
  </script>
</body>
</html>
